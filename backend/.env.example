# ========================================
# Backend Environment Variables - Свой Круг
# ========================================
# Copy this file to .env and fill in actual values
# NEVER commit .env to version control

# ========================================
# Application Settings
# ========================================
APP_NAME=Свой Круг API
APP_ENV=development  # development, staging, production
DEBUG=True
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# ========================================
# Security & Encryption
# ========================================
# Generate with: openssl rand -hex 32
SECRET_KEY=your-secret-key-change-this-in-production

# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=your-encryption-key-change-this

# JWT Settings
# Generate RS256 keys with: openssl genrsa -out private_key.pem 2048
JWT_ALGORITHM=RS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30
JWT_PRIVATE_KEY_PATH=keys/private_key.pem
JWT_PUBLIC_KEY_PATH=keys/public_key.pem

# ========================================
# Database Settings
# ========================================
# PostgreSQL (OLTP)
DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/svoy_krug
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# ClickHouse (OLAP)
CLICKHOUSE_HOST=localhost
CLICKHOUSE_PORT=8123
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=password
CLICKHOUSE_DATABASE=svoy_krug_analytics

# Redis (Cache & Queue)
REDIS_URL=redis://:password@localhost:6379/0
REDIS_CACHE_TTL=3600  # seconds

# ========================================
# Celery (Task Queue)
# ========================================
CELERY_BROKER_URL=redis://:password@localhost:6379/1
CELERY_RESULT_BACKEND=redis://:password@localhost:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json

# ========================================
# External APIs
# ========================================
# SMS.ru (SMS OTP)
SMS_RU_API_KEY=your-sms-ru-api-key
SMS_OTP_EXPIRY_MINUTES=5
SMS_RATE_LIMIT_PER_HOUR=5

# SendGrid (Email)
SENDGRID_API_KEY=your-sendgrid-api-key
SENDGRID_FROM_EMAIL=noreply@svoykrug.ru
SENDGRID_FROM_NAME=Свой Круг

# Firebase Cloud Messaging (Push Notifications)
FCM_SERVER_KEY=your-fcm-server-key
FCM_PROJECT_ID=your-firebase-project-id

# ========================================
# CRM Integrations
# ========================================
# YCLIENTS (Миндаль салон)
YCLIENTS_API_KEY=your-yclients-api-key
YCLIENTS_COMPANY_ID=your-company-id
YCLIENTS_BASE_URL=https://api.yclients.com/api/v1

# Iiko (Лисичкино гастромаркет)
IIKO_API_LOGIN=your-iiko-login
IIKO_API_PASSWORD=your-iiko-password
IIKO_ORGANIZATION_ID=your-organization-id
IIKO_BASE_URL=https://api-ru.iiko.services

# 1С (for partners using 1С)
ONEC_BASE_URL=http://your-1c-server:port
ONEC_USERNAME=your-1c-username
ONEC_PASSWORD=your-1c-password

# ========================================
# Monitoring & Logging
# ========================================
# Sentry (Error Tracking)
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=1.0

# Prometheus (Metrics)
PROMETHEUS_ENABLED=True
PROMETHEUS_PORT=9090

# ========================================
# CORS & Security Headers
# ========================================
CORS_ORIGINS=http://localhost:3000,http://localhost:8081  # Mobile app, web admin
CORS_ALLOW_CREDENTIALS=True
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOW_HEADERS=*

# ========================================
# Rate Limiting
# ========================================
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=60  # requests per IP per minute

# ========================================
# File Storage (Yandex Object Storage)
# ========================================
YANDEX_CLOUD_ACCESS_KEY_ID=your-access-key
YANDEX_CLOUD_SECRET_ACCESS_KEY=your-secret-key
YANDEX_CLOUD_BUCKET_NAME=svoy-krug-media
YANDEX_CLOUD_REGION=ru-central1

# ========================================
# Feature Flags
# ========================================
FEATURE_CROSS_PROMO_ENABLED=True
FEATURE_EVENTS_ENABLED=True
FEATURE_REFERRAL_ENABLED=False  # v1.5
FEATURE_GAMIFICATION_ENABLED=False  # v2.0

# ========================================
# Development Tools
# ========================================
# Enable only in development
DEBUG_TOOLBAR_ENABLED=True
SQL_ECHO=False  # Set to True to log all SQL queries
RELOAD_ON_CHANGE=True  # Auto-reload on code changes

# ========================================
# Testing
# ========================================
TEST_DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/svoy_krug_test
